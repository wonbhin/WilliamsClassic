<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Williams Classic Strategy</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0f1115; --card: #1e2329; --text: #eaecef; --green: #0ecb81; --red: #f6465d; --gold: #f0b90b; --input-bg: #2b3139; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Noto Sans KR', sans-serif; display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; padding: 20px; }
        .container { width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 15px; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ (ë“œë¡­ë‹¤ìš´ + ì„¤ì •) */
        .control-bar {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid #333;
        }
        
        select {
            background: var(--input-bg); color: #fff; border: 1px solid #444;
            padding: 8px 12px; border-radius: 6px; font-weight: bold; font-size: 1rem; cursor: pointer;
        }
        input {
            background: var(--input-bg); color: #fff; border: 1px solid #444;
            padding: 8px; width: 60px; text-align: center; border-radius: 6px; font-weight: bold; font-size: 1rem;
        }

        /* ë©”ì¸ ì¹´ë“œ */
        .card { background-color: var(--card); border-radius: 12px; padding: 25px; border: 1px solid #2b3139; }
        .mono { font-family: 'Roboto Mono', monospace; }
        
        /* ì¶”ì„¸ ë±ƒì§€ */
        .badge { display: inline-block; padding: 6px 15px; border-radius: 20px; font-weight: bold; font-size: 0.9rem; margin-bottom: 15px; }
        .trend-up { background: rgba(14, 203, 129, 0.15); color: var(--green); border: 1px solid var(--green); }
        .trend-down { background: rgba(246, 70, 93, 0.15); color: var(--red); border: 1px solid var(--red); }

        /* ê°€ê²© ì •ë³´ */
        .price-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; color: #888; }
        .action-box { text-align: center; padding: 20px; border: 2px solid #333; border-radius: 8px; background: #0b0e11; transition: 0.3s; }
        
        .main-price { font-size: 2.2rem; font-weight: 700; margin: 5px 0; }
        .sl-text { color: var(--red); font-weight: bold; margin-top: 10px; font-size: 1.1rem; }

        /* ìƒíƒœ ë©”ì‹œì§€ */
        .status-msg { font-size: 1rem; font-weight: bold; margin-top: 5px; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center; margin:10px 0;">ğŸ›ï¸ Williams Classic Multi</h2>

    <div class="control-bar">
        <select id="coinSelect" onchange="fetchData()">
            <option value="BTCUSDT">Bitcoin (BTC)</option>
            <option value="ETHUSDT">Ethereum (ETH)</option>
            <option value="SOLUSDT">Solana (SOL)</option>
            <option value="XRPUSDT">Ripple (XRP)</option>
        </select>

        <div style="display:flex; align-items:center; gap:8px;">
            <span style="font-size:0.9rem; color:#aaa;">ë…¸ì´ì¦ˆ(K)</span>
            <input type="number" id="kInput" value="0.5" step="0.1" onchange="updateUI()">
        </div>
    </div>

    <div class="card">
        <div style="text-align:center;">
            <div id="trendBadge" class="badge">ì¶”ì„¸ ë¶„ì„ ì¤‘...</div>
        </div>

        <div class="price-row mono">
            <span>í˜„ì¬ê°€: <b id="curPrice" style="color:#fff;">---</b></span>
            <span>20ì¼ì„ : <b id="maPrice" style="color:var(--gold);">---</b></span>
        </div>

        <div id="actionBox" class="action-box">
            <div id="actionTitle" style="color:#888; font-size:0.9rem;">ì˜¤ëŠ˜ì˜ ì§„ì… ëª©í‘œê°€</div>
            <div id="targetPrice" class="main-price mono">---</div>
            <div id="statusMsg" class="status-msg">ëŒ€ê¸° ì¤‘...</div>
        </div>

        <div style="text-align:center; margin-top:20px; border-top:1px dashed #444; padding-top:15px;">
            <div style="font-size:0.8rem; color:#888;">STOP LOSS (í•„ìˆ˜ ì˜ˆì•½)</div>
            <div id="stopPrice" class="sl-text mono">---</div>
        </div>
    </div>

    <div class="card" style="font-size:0.8rem; color:#888; line-height:1.5;">
        <b>ğŸ’¡ ì•ŒíŠ¸ì½”ì¸ ë§¤ë§¤ íŒ</b><br>
        * <b>XRP, SOL</b>ì€ ë³€ë™ì„±ì´ ì»¤ì„œ <b>K=0.6</b> ì¶”ì²œ<br>
        * <b>BTC, ETH</b>ëŠ” ì •ì„ëŒ€ë¡œ <b>K=0.5</b> ì¶”ì²œ<br>
        * ì¶”ì„¸(20ì¼ì„ ) ì—­í–‰ ë§¤ë§¤ ê¸ˆì§€<br>
        * ë‚´ì¼ ì•„ì¹¨ 09:00ì— ì „ëŸ‰ ë§¤ë„ (ì˜¤ë²„ë‚˜ì‡)
    </div>
</div>

<script>
    let market = { current: 0, open: 0, range: 0, ma20: 0 };
    let precision = 1; // ì†Œìˆ˜ì  ìë¦¬ìˆ˜ (BTC:1, XRP:4 ë“±)

    // 2ì´ˆë§ˆë‹¤ ê°±ì‹ 
    setInterval(fetchData, 2000);
    fetchData();

    async function fetchData() {
        try {
            const symbol = document.getElementById('coinSelect').value;
            
            // ì†Œìˆ˜ì  ìë¦¬ìˆ˜ ìë™ ì¡°ì •
            if(symbol === 'BTCUSDT') precision = 1;
            else if(symbol === 'ETHUSDT') precision = 2;
            else if(symbol === 'SOLUSDT') precision = 2;
            else if(symbol === 'XRPUSDT') precision = 4;

            // API í˜¸ì¶œ
            const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=1d&limit=25`);
            const data = await res.json();
            
            const today = data[data.length - 1];
            const prev = data[data.length - 2];

            market.current = parseFloat(today[4]);
            market.open = parseFloat(today[1]);
            market.range = parseFloat(prev[2]) - parseFloat(prev[3]);

            // 20ì¼ MA ê³„ì‚°
            let sum = 0;
            for(let i = data.length - 21; i < data.length - 1; i++) {
                sum += parseFloat(data[i][4]);
            }
            market.ma20 = sum / 20;

            updateUI();
        } catch(e) { console.log(e); }
    }

    function updateUI() {
        const k = parseFloat(document.getElementById('kInput').value);
        const badge = document.getElementById('trendBadge');
        const box = document.getElementById('actionBox');
        const title = document.getElementById('actionTitle');
        const target = document.getElementById('targetPrice');
        const stop = document.getElementById('stopPrice');
        const msg = document.getElementById('statusMsg');

        // ê¸°ë³¸ ì •ë³´ í‘œì‹œ
        document.getElementById('curPrice').innerText = market.current.toFixed(precision);
        document.getElementById('maPrice').innerText = market.ma20.toFixed(precision);

        // ë¡œì§ íŒë³„
        if (market.current > market.ma20) {
            // ìƒìŠ¹ì¥ (Long)
            badge.className = "badge trend-up";
            badge.innerText = "â–² ìƒìŠ¹ ì¶”ì„¸ (Only LONG)";
            
            const entry = market.open + (market.range * k);
            const sl = entry - (market.range * 0.5);

            title.innerText = "LONG ì§„ì…ê°€ (Buy Stop)";
            target.innerText = entry.toFixed(precision);
            target.style.color = "var(--green)";
            stop.innerText = sl.toFixed(precision);
            box.style.borderColor = "var(--green)";

            // ì²´ê²° ìƒíƒœ í™•ì¸
            if(market.current >= entry) {
                msg.innerText = "ğŸš€ ì²´ê²° ì™„ë£Œ (HOLD)";
                msg.style.color = "var(--green)";
                box.style.background = "rgba(14, 203, 129, 0.1)";
            } else {
                msg.innerText = "ëª©í‘œê°€ ë„ë‹¬ ëŒ€ê¸° ì¤‘...";
                msg.style.color = "#666";
                box.style.background = "#0b0e11";
            }

        } else {
            // í•˜ë½ì¥ (Short)
            badge.className = "badge trend-down";
            badge.innerText = "â–¼ í•˜ë½ ì¶”ì„¸ (Only SHORT)";
            
            const entry = market.open - (market.range * k);
            const sl = entry + (market.range * 0.5);

            title.innerText = "SHORT ì§„ì…ê°€ (Sell Stop)";
            target.innerText = entry.toFixed(precision);
            target.style.color = "var(--red)";
            stop.innerText = sl.toFixed(precision);
            box.style.borderColor = "var(--red)";

            // ì²´ê²° ìƒíƒœ í™•ì¸
            if(market.current <= entry) {
                msg.innerText = "ğŸš€ ì²´ê²° ì™„ë£Œ (HOLD)";
                msg.style.color = "var(--red)";
                box.style.background = "rgba(246, 70, 93, 0.1)";
            } else {
                msg.innerText = "ëª©í‘œê°€ ë„ë‹¬ ëŒ€ê¸° ì¤‘...";
                msg.style.color = "#666";
                box.style.background = "#0b0e11";
            }
        }
    }
</script>
</body>
</html>